(window.webpackJsonp=window.webpackJsonp||[]).push([[31],{108:function(e,t,n){"use strict";n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return d}));var a=n(0),r=n.n(a);function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){c(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},c=Object.keys(e);for(a=0;a<c.length;a++)n=c[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(a=0;a<c.length;a++)n=c[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var b=r.a.createContext({}),s=function(e){var t=r.a.useContext(b),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},p=function(e){var t=s(e.components);return r.a.createElement(b.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return r.a.createElement(r.a.Fragment,{},t)}},m=r.a.forwardRef((function(e,t){var n=e.components,a=e.mdxType,c=e.originalType,i=e.parentName,b=l(e,["components","mdxType","originalType","parentName"]),p=s(n),m=a,d=p["".concat(i,".").concat(m)]||p[m]||u[m]||c;return n?r.a.createElement(d,o(o({ref:t},b),{},{components:n})):r.a.createElement(d,o({ref:t},b))}));function d(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var c=n.length,i=new Array(c);i[0]=m;var o={};for(var l in t)hasOwnProperty.call(t,l)&&(o[l]=t[l]);o.originalType=e,o.mdxType="string"==typeof e?e:a,i[1]=o;for(var b=2;b<c;b++)i[b]=n[b];return r.a.createElement.apply(null,i)}return r.a.createElement.apply(null,n)}m.displayName="MDXCreateElement"},97:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return i})),n.d(t,"metadata",(function(){return o})),n.d(t,"toc",(function(){return l})),n.d(t,"default",(function(){return s}));var a=n(3),r=n(7),c=(n(0),n(108)),i={slug:"2021-04-05-db-migration-on-infrastructure-layer-project",title:"\u3010.NET\u3001C#\u3011\u8907\u6570\u30b9\u30bf\u30fc\u30c8\u30a2\u30c3\u30d7\u306e\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u69cb\u6210\u306e\u30bd\u30ea\u30e5\u30fc\u30b7\u30e7\u30f3\u3067DB\u30de\u30a4\u30b0\u30ec\u30fc\u30b7\u30e7\u30f3\u30d5\u30a1\u30a4\u30eb\u3092\u30a4\u30f3\u30d5\u30e9\u5c64\u306e\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306b\u751f\u6210\u3059\u308b",author:"sugu-sano",author_title:"web application developper",author_url:"https://github.com/sugu-sano",author_image_url:"https://avatars.githubusercontent.com/u/70303693?s=60&v=4",tags:[".NET",".NET Core","db migration","C#","EntityFramework Core"]},o={permalink:"/dev-blog/blog/2021-04-05-db-migration-on-infrastructure-layer-project",editUrl:"https://github.com/facebook/docusaurus/edit/master/website/blog/blog/2021-04-05-db-migration-on-infrastructure-layer-project.md",source:"@site/blog/2021-04-05-db-migration-on-infrastructure-layer-project.md",description:"\u304d\u3063\u304b\u3051",date:"2021-04-05T00:00:00.000Z",tags:[{label:".NET",permalink:"/dev-blog/blog/tags/net"},{label:".NET Core",permalink:"/dev-blog/blog/tags/net-core"},{label:"db migration",permalink:"/dev-blog/blog/tags/db-migration"},{label:"C#",permalink:"/dev-blog/blog/tags/c"},{label:"EntityFramework Core",permalink:"/dev-blog/blog/tags/entity-framework-core"}],title:"\u3010.NET\u3001C#\u3011\u8907\u6570\u30b9\u30bf\u30fc\u30c8\u30a2\u30c3\u30d7\u306e\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u69cb\u6210\u306e\u30bd\u30ea\u30e5\u30fc\u30b7\u30e7\u30f3\u3067DB\u30de\u30a4\u30b0\u30ec\u30fc\u30b7\u30e7\u30f3\u30d5\u30a1\u30a4\u30eb\u3092\u30a4\u30f3\u30d5\u30e9\u5c64\u306e\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306b\u751f\u6210\u3059\u308b",readingTime:5.86,truncated:!0,nextItem:{title:"Docusaurus \u3067\u30b7\u30f3\u30bf\u30c3\u30af\u30b9\u30cf\u30a4\u30e9\u30a4\u30c8\u5bfe\u5fdc\u8a00\u8a9e\u3092\u8ffd\u52a0\u3059\u308b\u65b9\u6cd5",permalink:"/dev-blog/blog/2021-03-17-add-syntax-highlighting-theme-in-docusaurus"}},l=[{value:"\u304d\u3063\u304b\u3051",id:"\u304d\u3063\u304b\u3051",children:[]},{value:"<code>Infrastructure</code>\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u4ee5\u4e0b\u306b\u30de\u30a4\u30b0\u30ec\u30fc\u30b7\u30e7\u30f3\u30d5\u30a1\u30a4\u30eb\u3092\u751f\u6210\u3067\u304d\u308b\u3088\u3046\u306b\u3059\u308b",id:"infrastructure\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u4ee5\u4e0b\u306b\u30de\u30a4\u30b0\u30ec\u30fc\u30b7\u30e7\u30f3\u30d5\u30a1\u30a4\u30eb\u3092\u751f\u6210\u3067\u304d\u308b\u3088\u3046\u306b\u3059\u308b",children:[]}],b={toc:l};function s(e){var t=e.components,n=Object(r.a)(e,["components"]);return Object(c.b)("wrapper",Object(a.a)({},b,n,{components:t,mdxType:"MDXLayout"}),Object(c.b)("svg",{height:"256",viewBox:"0 0 64 64",width:"256",xmlns:"http://www.w3.org/2000/svg"},Object(c.b)("g",{id:"Layer_34","data-name":"Layer 34"},Object(c.b)("g",{id:"database_server","data-name":"database server"},Object(c.b)("rect",{fill:"#57a4ff",height:"12",rx:"2",width:"40",x:"3",y:"19"}),Object(c.b)("path",{d:"m43 21v8a2.006 2.006 0 0 1 -2 2h-4a2.006 2.006 0 0 0 2-2v-8a2.006 2.006 0 0 0 -2-2h4a2.006 2.006 0 0 1 2 2z",fill:"#2488ff"}),Object(c.b)("path",{d:"m33 31h6v4h-6z",fill:"#acabb1"}),Object(c.b)("path",{d:"m33 15h6v4h-6z",fill:"#acabb1"}),Object(c.b)("path",{d:"m36 15h3v4h-3z",fill:"#898890"}),Object(c.b)("path",{d:"m36 31h3v4h-3z",fill:"#898890"}),Object(c.b)("rect",{fill:"#57a4ff",height:"12",rx:"2",width:"40",x:"3",y:"35"}),Object(c.b)("path",{d:"m43 37v8a2.006 2.006 0 0 1 -2 2h-4a2.006 2.006 0 0 0 2-2v-8a2.006 2.006 0 0 0 -2-2h4a2.006 2.006 0 0 1 2 2z",fill:"#2488ff"}),Object(c.b)("path",{d:"m15 39h4v4h-4z",fill:"#00b6bd"}),Object(c.b)("path",{d:"m15 23h4v4h-4z",fill:"#00b6bd"}),Object(c.b)("rect",{fill:"#57a4ff",height:"12",rx:"2",width:"40",x:"3",y:"3"}),Object(c.b)("path",{d:"m43 5v8a2.006 2.006 0 0 1 -2 2h-4a2.006 2.006 0 0 0 2-2v-8a2.006 2.006 0 0 0 -2-2h4a2.006 2.006 0 0 1 2 2z",fill:"#2488ff"}),Object(c.b)("path",{d:"m15 7h4v4h-4z",fill:"#00b6bd"}),Object(c.b)("path",{d:"m7 31h6v4h-6z",fill:"#acabb1"}),Object(c.b)("path",{d:"m7 15h6v4h-6z",fill:"#acabb1"}),Object(c.b)("path",{d:"m10 15h3v4h-3z",fill:"#898890"}),Object(c.b)("path",{d:"m10 31h3v4h-3z",fill:"#898890"}),Object(c.b)("path",{d:"m7 39h4v4h-4z",fill:"#ff7956"}),Object(c.b)("path",{d:"m7 23h4v4h-4z",fill:"#ff7956"}),Object(c.b)("path",{d:"m7 7h4v4h-4z",fill:"#ff7956"}),Object(c.b)("path",{d:"m61 46v10c0 2.76-8.06 5-18 5s-18-2.24-18-5v-10c0 2.76 8.06 5 18 5s18-2.24 18-5z",fill:"#ffde55"}),Object(c.b)("path",{d:"m61 36v10c0 2.76-8.06 5-18 5s-18-2.24-18-5v-10c0 2.76 8.06 5 18 5s18-2.24 18-5z",fill:"#ffde55"}),Object(c.b)("path",{d:"m61 26v10c0 2.76-8.06 5-18 5s-18-2.24-18-5v-10c0 2.76 8.06 5 18 5s18-2.24 18-5z",fill:"#ffde55"}),Object(c.b)("g",{fill:"#ffcd00"},Object(c.b)("ellipse",{cx:"43",cy:"26",rx:"18",ry:"5"}),Object(c.b)("path",{d:"m61 46v10c0 2.76-8.06 5-18 5-.68 0-1.34-.01-2-.04 9-.27 16-2.39 16-4.96v-6.86c2.5-.86 4-1.95 4-3.14z"}),Object(c.b)("path",{d:"m61 36v10c0 1.19-1.5 2.28-4 3.14a46.109 46.109 0 0 1 -14 1.86c-.68 0-1.34-.01-2-.04 9-.27 16-2.39 16-4.96v-6.86c2.5-.86 4-1.95 4-3.14z"}),Object(c.b)("path",{d:"m61 26v10c0 1.19-1.5 2.28-4 3.14a46.109 46.109 0 0 1 -14 1.86c-.68 0-1.34-.01-2-.04 9-.27 16-2.39 16-4.96v-6.86c2.5-.86 4-1.95 4-3.14z"})),Object(c.b)("path",{d:"m61 26c0 1.19-1.5 2.28-4 3.14a46.109 46.109 0 0 1 -14 1.86c-.68 0-1.34-.01-2-.04 9-.27 16-2.39 16-4.96s-7-4.69-16-4.96c.66-.03 1.32-.04 2-.04 9.94 0 18 2.24 18 5z",fill:"#ebbf00"}),Object(c.b)("path",{d:"m57 46v3.14a46.109 46.109 0 0 1 -14 1.86c-.68 0-1.34-.01-2-.04 9-.27 16-2.39 16-4.96z",fill:"#ffde55"}),Object(c.b)("path",{d:"m57 36v3.14a46.109 46.109 0 0 1 -14 1.86c-.68 0-1.34-.01-2-.04 9-.27 16-2.39 16-4.96z",fill:"#ffde55"}),Object(c.b)("path",{d:"m43.82 20.01a2.986 2.986 0 0 0 -2.82-2.01h-1v-2h1a3.009 3.009 0 0 0 3-3v-8a3.009 3.009 0 0 0 -3-3h-36a3.009 3.009 0 0 0 -3 3v8a3.009 3.009 0 0 0 3 3h1v2h-1a3.009 3.009 0 0 0 -3 3v8a3.009 3.009 0 0 0 3 3h1v2h-1a3.009 3.009 0 0 0 -3 3v8a3.009 3.009 0 0 0 3 3h19v8c0 3.94 9.56 6 19 6s19-2.06 19-6v-30c0-3.83-9.01-5.87-18.18-5.99zm-38.82-6.01a1 1 0 0 1 -1-1v-8a1 1 0 0 1 1-1h36a1 1 0 0 1 1 1v8a1 1 0 0 1 -1 1zm33 2v2h-4v-2zm-6 0v2h-18v-2zm-20 0v2h-4v-2zm12 30h-19a1 1 0 0 1 -1-1v-8a1 1 0 0 1 1-1h19zm-16-12v-2h4v2zm16 0h-10v-2h10zm0-8v4h-19a1 1 0 0 1 -1-1v-8a1 1 0 0 1 1-1h36a.7.7 0 0 1 .14.03c-8.8.25-17.14 2.29-17.14 5.97zm36 30c0 1.36-6 4-17 4s-17-2.64-17-4v-7.18c3.29 2.09 10.16 3.18 17 3.18s13.71-1.09 17-3.18zm0-10c0 1.36-6 4-17 4s-17-2.64-17-4v-7.18c3.29 2.09 10.16 3.18 17 3.18s13.71-1.09 17-3.18zm0-10c0 1.36-6 4-17 4s-17-2.64-17-4v-7.18c3.29 2.09 10.16 3.18 17 3.18s13.71-1.09 17-3.18zm-17-6c-11 0-17-2.64-17-4s6-4 17-4 17 2.64 17 4-6 4-17 4z"}),Object(c.b)("path",{d:"m42 35h2v2h-2z"}),Object(c.b)("path",{d:"m42 46h2v2h-2z"}),Object(c.b)("path",{d:"m42 55h2v2h-2z"}),Object(c.b)("path",{d:"m11 22h-4a1 1 0 0 0 -1 1v4a1 1 0 0 0 1 1h4a1 1 0 0 0 1-1v-4a1 1 0 0 0 -1-1zm-1 4h-2v-2h2z"}),Object(c.b)("path",{d:"m19 22h-4a1 1 0 0 0 -1 1v4a1 1 0 0 0 1 1h4a1 1 0 0 0 1-1v-4a1 1 0 0 0 -1-1zm-1 4h-2v-2h2z"}),Object(c.b)("path",{d:"m11 6h-4a1 1 0 0 0 -1 1v4a1 1 0 0 0 1 1h4a1 1 0 0 0 1-1v-4a1 1 0 0 0 -1-1zm-1 4h-2v-2h2z"}),Object(c.b)("path",{d:"m19 6h-4a1 1 0 0 0 -1 1v4a1 1 0 0 0 1 1h4a1 1 0 0 0 1-1v-4a1 1 0 0 0 -1-1zm-1 4h-2v-2h2z"}),Object(c.b)("path",{d:"m22 6h14v2h-14z"}),Object(c.b)("path",{d:"m38 6h2v2h-2z"}),Object(c.b)("path",{d:"m22 10h14v2h-14z"}),Object(c.b)("path",{d:"m38 10h2v2h-2z"}),Object(c.b)("path",{d:"m11 38h-4a1 1 0 0 0 -1 1v4a1 1 0 0 0 1 1h4a1 1 0 0 0 1-1v-4a1 1 0 0 0 -1-1zm-1 4h-2v-2h2z"}),Object(c.b)("path",{d:"m19 38h-4a1 1 0 0 0 -1 1v4a1 1 0 0 0 1 1h4a1 1 0 0 0 1-1v-4a1 1 0 0 0 -1-1zm-1 4h-2v-2h2z"})))),Object(c.b)("h2",{id:"\u304d\u3063\u304b\u3051"},"\u304d\u3063\u304b\u3051"),Object(c.b)("p",null,Object(c.b)("inlineCode",{parentName:"p"},"dotnet ef migrations"),"\u30b3\u30de\u30f3\u30c9\u3067\u30de\u30a4\u30b0\u30ec\u30fc\u30b7\u30e7\u30f3\u30d5\u30a1\u30a4\u30eb\u3092\u751f\u6210\u3059\u308b\u969b\u306f\u3001DB \u30b3\u30f3\u30c6\u30ad\u30b9\u30c8\u3092 DI \u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\u305f\u3081\u3001\u5b9f\u884c\u5f62\u5f0f\u306e\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3067\u30b3\u30de\u30f3\u30c9\u3092\u6253\u3064\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002"),Object(c.b)("p",null,"\u3057\u304b\u3057\u3001\u4e0b\u8a18\u306e\u7528\u306b\u30bd\u30ea\u30e5\u30fc\u30b7\u30e7\u30f3\u69cb\u6210\u306e\u3088\u3046\u306b\u8907\u6570\u306e\u30b9\u30bf\u30fc\u30c8\u30a2\u30c3\u30d7\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\uff08",Object(c.b)("inlineCode",{parentName:"p"},"WebApi"),"\u3001",Object(c.b)("inlineCode",{parentName:"p"},"WebSite"),"\uff09\u304c\u3042\u308b\u5834\u5408\u3001",Object(c.b)("inlineCode",{parentName:"p"},"WebApi"),"\u3001",Object(c.b)("inlineCode",{parentName:"p"},"WebSite"),"\u306e\u3069\u3061\u3089\u304b\u3067\u884c\u3046\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u304c\u3001\u3069\u3061\u3089\u304b\u7247\u65b9\u306e\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306b\u3060\u3051\u30de\u30a4\u30b0\u30ec\u30fc\u30b7\u30e7\u30f3\u30d5\u30a1\u30a4\u30eb\u304c\u3042\u308b\u306e\u306f\u9055\u548c\u611f\u304c\u3042\u308a\u307e\u3059\u3002"),Object(c.b)("pre",null,Object(c.b)("code",{parentName:"pre",className:"language-bash"},"$ tree .\n\u251c\u2500\u2500 ECommerceSample.sln\n\u251c\u2500\u2500 LICENSE\n\u251c\u2500\u2500 README.md\n\u2514\u2500\u2500 src\n    \u251c\u2500\u2500 Application\n    \u2502\xa0\xa0 \u251c\u2500\u2500 Application.csproj\n    \u251c\u2500\u2500 Domain\n    \u2502\xa0\xa0 \u251c\u2500\u2500 Domain.csproj\n    \u251c\u2500\u2500 Infrastructure\n    \u2502\xa0\xa0 \u251c\u2500\u2500 Infrastructure.csproj\n    \u251c\u2500\u2500 WebApi\n    \u2502\xa0\xa0 \u251c\u2500\u2500 Controllers\n    \u2502\xa0\xa0 \u2502\xa0\xa0 \u2514\u2500\u2500 WeatherForecastController.cs\n    \u2502\xa0\xa0 \u251c\u2500\u2500 Program.cs\n    \u2502\xa0\xa0 \u251c\u2500\u2500 Properties\n    \u2502\xa0\xa0 \u2502\xa0\xa0 \u2514\u2500\u2500 launchSettings.json\n    \u2502\xa0\xa0 \u251c\u2500\u2500 Startup.cs\n    \u2502\xa0\xa0 \u251c\u2500\u2500 WeatherForecast.cs\n    \u2502\xa0\xa0 \u251c\u2500\u2500 WebApi.csproj\n    \u2502\xa0\xa0 \u251c\u2500\u2500 appsettings.Development.json\n    \u2502\xa0\xa0 \u251c\u2500\u2500 appsettings.json\n    \u2514\u2500\u2500 WebSite\n        \u251c\u2500\u2500 Pages\n        \u2502\xa0\xa0 \u251c\u2500\u2500 Index.cshtml\n        \u2502\xa0\xa0 \u251c\u2500\u2500 Index.cshtml.cs\n        \u2502\xa0\xa0 (\u7565...)\n        \u251c\u2500\u2500 Program.cs\n        \u251c\u2500\u2500 Properties\n        \u2502\xa0\xa0 \u2514\u2500\u2500 launchSettings.json\n        \u251c\u2500\u2500 Startup.cs\n        \u251c\u2500\u2500 WebSite.csproj\n        \u251c\u2500\u2500 appsettings.Development.json\n        \u251c\u2500\u2500 appsettings.json\n        \u2514\u2500\u2500 wwwroot\n            \u251c\u2500\u2500 css\n            (\u7565...)\n")),Object(c.b)("p",null,"\u3067\u304d\u308c\u3070\u5171\u901a\u3067\u547c\u3073\u51fa\u3059",Object(c.b)("inlineCode",{parentName:"p"},"Infrastructure"),"\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u76f4\u4e0b\u306b\u30de\u30a4\u30b0\u30ec\u30fc\u30b7\u30e7\u30f3\u30d5\u30a1\u30a4\u30eb\u3092\u751f\u6210\u3057\u305f\u3044\u3068\u3053\u308d\u3067\u3059\u3002"),Object(c.b)("p",null,"\u3057\u304b\u3057\u4f5c\u6210\u3057\u3066\u3044\u305f\u30bd\u30ea\u30e5\u30fc\u30b7\u30e7\u30f3\u69cb\u6210\u3067\u306f",Object(c.b)("inlineCode",{parentName:"p"},"Infrastructure"),"\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u304c\u30af\u30e9\u30b9\u30e9\u30a4\u30d6\u30e9\u30ea\u306e\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3067\u3057\u305f\u3002"),Object(c.b)("p",null,"\u305d\u306e\u305f\u3081\u3001",Object(c.b)("inlineCode",{parentName:"p"},"Infrastructure"),"\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u76f4\u4e0b\u3067",Object(c.b)("inlineCode",{parentName:"p"},"dotnet ef migrations"),"\u30b3\u30de\u30f3\u30c9\u3092\u3046\u3063\u3066\u3082\u30a8\u30e9\u30fc\u306b\u306a\u3063\u3066\u30de\u30a4\u30b0\u30ec\u30fc\u30b7\u30e7\u30f3\u30d5\u30a1\u30a4\u30eb\u3092\u751f\u6210\u3067\u304d\u307e\u305b\u3093\u3002"),Object(c.b)("p",null,"\u305d\u3053\u3067",Object(c.b)("inlineCode",{parentName:"p"},"Infrastructure"),"\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u30af\u30e9\u30b9\u30e9\u30a4\u30d6\u30e9\u30ea\u304b\u3089\u30b3\u30f3\u30bd\u30fc\u30eb\u30a2\u30d7\u30ea\u306b\u5909\u3048\u3066\u3057\u307e\u3063\u3066\u3001DI \u30b3\u30f3\u30c6\u30ca\u3092\u8d77\u52d5\u3067\u304d\u308b\u7528\u306b\u5909\u66f4\u3057\u307e\u3059\u3002"),Object(c.b)("h2",{id:"infrastructure\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u4ee5\u4e0b\u306b\u30de\u30a4\u30b0\u30ec\u30fc\u30b7\u30e7\u30f3\u30d5\u30a1\u30a4\u30eb\u3092\u751f\u6210\u3067\u304d\u308b\u3088\u3046\u306b\u3059\u308b"},Object(c.b)("inlineCode",{parentName:"h2"},"Infrastructure"),"\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u4ee5\u4e0b\u306b\u30de\u30a4\u30b0\u30ec\u30fc\u30b7\u30e7\u30f3\u30d5\u30a1\u30a4\u30eb\u3092\u751f\u6210\u3067\u304d\u308b\u3088\u3046\u306b\u3059\u308b"),Object(c.b)("p",null,"NUGET \u304b\u3089.NET \u6c4e\u7528\u30db\u30b9\u30c8\u3068 DI\uff08\u4f9d\u5b58\u6027\u6ce8\u5165\uff09\u306e\u30e9\u30a4\u30d6\u30e9\u30ea\u306e\u53c2\u7167\u3092",Object(c.b)("inlineCode",{parentName:"p"},"Infrastructure"),"\u306b\u8ffd\u52a0\u3057\u307e\u3059\u3002"),Object(c.b)("pre",null,Object(c.b)("code",{parentName:"pre",className:"language-bash"},"cd /path/to/Infrastructure\ndotnet add package Microsoft.Extensions.Hosting\ndotnet add package Microsoft.Extensions.DependencyInjection\n")),Object(c.b)("p",null,"\u3055\u3089\u306b\u30de\u30a4\u30b0\u30ec\u30fc\u30b7\u30e7\u30f3\u306e\u305f\u3081\u306b\u30a8\u30f3\u30c6\u30a3\u30c6\u30a3\u30d5\u30ec\u30fc\u30e0\u30ef\u30fc\u30af\u3068 DB\uff08\u4eca\u56de\u306f SQLite\uff09\u30d7\u30ed\u30d0\u30a4\u30c0\u3082\u8ffd\u52a0\u3057\u307e\u3059\u3002"),Object(c.b)("pre",null,Object(c.b)("code",{parentName:"pre",className:"language-bash"},"dotnet add package Microsoft.EntityFrameworkCore\ndotnet add package Microsoft.EntityFrameworkCore.Design\ndotnet add package Microsoft.EntityFrameworkCore.Sqlite\n")),Object(c.b)("p",null,"\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u30d5\u30a1\u30a4\u30eb\u306b\u4e0b\u8a18\u306e\u3088\u3046\u306b\u8ffd\u52a0\u3055\u308c\u308b\u306f\u305a\u3067\u3059\u3002"),Object(c.b)("pre",null,Object(c.b)("code",{parentName:"pre",className:"language-xml"},'<Project Sdk="Microsoft.NET.Sdk">\n  \x3c!--\u7565--\x3e\n  <ItemGroup>\n    <PackageReference Include="Microsoft.EntityFrameworkCore" Version="5.0.4" />\n    <PackageReference Include="Microsoft.EntityFrameworkCore.Design" Version="5.0.4">\n      <PrivateAssets>all</PrivateAssets>\n      <IncludeAssets>runtime; build; native; contentfiles; analyzers; buildtransitive</IncludeAssets>\n    </PackageReference>\n    <PackageReference Include="Microsoft.EntityFrameworkCore.Sqlite" Version="5.0.4" />\n    <PackageReference Include="Microsoft.EntityFrameworkCore.Tools" Version="5.0.4">\n      <PrivateAssets>all</PrivateAssets>\n      <IncludeAssets>runtime; build; native; contentfiles; analyzers; buildtransitive</IncludeAssets>\n    </PackageReference>\n    <PackageReference Include="Microsoft.Extensions.DependencyInjection" Version="5.0.1" />\n    <PackageReference Include="Microsoft.Extensions.Hosting" Version="5.0.0" />\n  </ItemGroup>\n  \x3c!--\u7565--\x3e\n</Project>\n')),Object(c.b)("p",null,"\u6b21\u306b DB \u306e\u30e2\u30c7\u30eb\u306e\u30af\u30e9\u30b9\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002"),Object(c.b)("p",null,"\u79c1\u306f\u30c9\u30e1\u30a4\u30f3\u30e2\u30c7\u30eb\u3068 DB \u30e2\u30c7\u30eb\u3092\u660e\u78ba\u306b\u5206\u3051\u308b\u306e\u304c\u597d\u307f\u306a\u306e\u3067",Object(c.b)("inlineCode",{parentName:"p"},"Infrastructure"),"\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306b\u4f5c\u6210\u3057\u307e\u3059\u3002"),Object(c.b)("pre",null,Object(c.b)("code",{parentName:"pre",className:"language-csharp"},"public record AdminAccount\n{\n    public int Id { get; init; }\n    public DateTime CreateAt { get; init; }\n    public DateTime? UpdatedAt { get; init; }\n    public string AccountName { get; init; }\n    public bool Enabled { get; init; }\n    public AdminAccountRole[] AdminAccountRoles { get; init; }\n}\n\npublic class AdminAccountConfiguration : IEntityTypeConfiguration<AdminAccount>\n{\n    public void Configure(EntityTypeBuilder<AdminAccount> builder)\n    {\n        builder.HasKey(adminAccount => adminAccount.Id);\n        builder.Property(adminAccount => adminAccount.AccountName).IsRequired(true);\n        builder.Property(adminAccount => adminAccount.Enabled).IsRequired(true);\n        builder.Property(adminAccount => adminAccount.CreateAt).IsRequired(true);\n        builder.Property(adminAccount => adminAccount.UpdatedAt).IsRequired(false);\n    }\n}\n\n/*\n * \u4ed6\u306e\u30e2\u30c7\u30eb\u306f\u7701\u7565\u3057\u307e\u3059\n */\n")),Object(c.b)("p",null,"DB \u30b3\u30f3\u30c6\u30ad\u30b9\u30c8\u3092\u7528\u610f\u3057\u307e\u3059\u3002"),Object(c.b)("p",null,"\u4eca\u56de\u306f\u901a\u5e38\u306e DB \u30b3\u30f3\u30c6\u30ad\u30b9\u30c8\u3068\u305d\u308c\u3092\u7d99\u627f\u3057\u305f\u30ed\u30fc\u30ab\u30eb\u958b\u767a\u7528\u306e SQLite \u7528\u306e DB \u30b3\u30f3\u30c6\u30ad\u30b9\u30c8\u306e\uff12\u3064\u3092\u7528\u610f\u3057\u307e\u3059\u3002"),Object(c.b)("pre",null,Object(c.b)("code",{parentName:"pre",className:"language-csharp"},'public class ECommerceDbContext : DbContext\n{\n    public DbSet<AdminAccount> AdminAccounts { get; set; }\n    public DbSet<AdminAccountRole> AdminAccountRoles { get; set; }\n    public DbSet<AdminRole> AdminRoles { get; set; }\n    public DbSet<AdminRolePermission> AdminRolePermissions { get; set; }\n    public DbSet<AdminPermission> AdminPermissions { get; set; }\n    public ECommerceDbContext(DbContextOptions<ECommerceDbContext> options) : base(options) { }\n\n    protected override void OnModelCreating(ModelBuilder builder)\n    {\n        base.OnModelCreating(builder);\n        builder.ApplyConfiguration(new AdminAccountConfiguration());\n        builder.ApplyConfiguration(new AdminAccountRoleConfiguration());\n        // \u7565...\n    }\n}\n\npublic class SqliteECommerceDbContext : ECommerceDbContext\n{\n    public SqliteECommerceDbContext(DbContextOptions<ECommerceDbContext> options) : base(options) { }\n    protected override void OnConfiguring(DbContextOptionsBuilder builder)\n    {\n        builder.UseSqlite("Data Source=ECommerceSample.sqlite");\n    }\n}\n')),Object(c.b)("p",null,"\u3053\u3053\u307e\u3067\u5b8c\u4e86\u3057\u305f\u3089",Object(c.b)("inlineCode",{parentName:"p"},"Infrastructure"),"\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u30af\u30e9\u30b9\u30e9\u30a4\u30d6\u30ea\u304b\u3089\u30b3\u30f3\u30bd\u30fc\u30eb\u30a2\u30d7\u30ea\uff08\u5b9f\u884c\u30d5\u30a1\u30a4\u30eb\uff09\u306b\u5909\u66f4\u3057\u307e\u3059\u3002"),Object(c.b)("p",null,Object(c.b)("inlineCode",{parentName:"p"},"<OutputType>Exe</OutputType>"),"\u3092\u8ffd\u52a0\u3057\u307e\u3059\u3002"),Object(c.b)("pre",null,Object(c.b)("code",{parentName:"pre",className:"language-diff"},'  <Project Sdk="Microsoft.NET.Sdk">\n    \x3c!--\u7565--\x3e\n    <PropertyGroup>\n+     <OutputType>Exe</OutputType>\n      <TargetFramework>net5.0</TargetFramework>\n      <AssemblyName>ECommerceSample.Infrastructure</AssemblyName>\n      <RootNamespace>ECommerceSample.Infrastructure</RootNamespace>\n      <Nullable>disable</Nullable>\n    </PropertyGroup>\n   \x3c!--\u7565--\x3e\n  </Project>\n')),Object(c.b)("p",null,"DI \u30b3\u30f3\u30c6\u30ca\u306b DB \u30b3\u30f3\u30c6\u30ad\u30b9\u30c8\u306e DI \u8a2d\u5b9a\u3092\u8ffd\u52a0\u3057\u307e\u3059\u3002"),Object(c.b)("p",null,Object(c.b)("inlineCode",{parentName:"p"},"WebSite"),"\u3084",Object(c.b)("inlineCode",{parentName:"p"},"WebApi"),"\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3067\u3082\u540c\u3058\u7528\u306b\u8a2d\u5b9a\u3059\u308b\u3068\u8003\u3048\u308b\u3068\u62e1\u5f35\u30e1\u30bd\u30c3\u30c9\u3067\u5171\u901a\u5316\u3057\u3066\u304a\u304f\u3068\u4fbf\u5229\u304b\u3068\u601d\u3044\u307e\u3059\u3002"),Object(c.b)("pre",null,Object(c.b)("code",{parentName:"pre",className:"language-csharp:DefaultDependencyInjection.cs"},"public static class DefaultDependencyInjection\n{\n    public static IServiceCollection AddInfrastructureServices(this IServiceCollection services)\n    {\n        services.AddDbContext<ECommerceDbContext>();\n        services.AddDbContext<SqliteECommerceDbContext>();\n        return services;\n    }\n}\n")),Object(c.b)("p",null,"\u30a8\u30f3\u30c8\u30ea\u30fc\u30dd\u30a4\u30f3\u30c8\u3092\u4f5c\u6210\u3057\u30db\u30b9\u30c6\u30a3\u30f3\u30b0\u69cb\u6210\u3092\u3057\u3066\u4e0a\u8a18\u306e DI \u8a2d\u5b9a\u3092\u547c\u3073\u51fa\u3057\u307e\u3059\u3002"),Object(c.b)("pre",null,Object(c.b)("code",{parentName:"pre",className:"language-csharp"},"class Program\n{\n    static async Task Main(string[] args)\n    {\n        using IHost host = CreateHostBuilder(args).Build();\n        await host.RunAsync();\n    }\n\n    static IHostBuilder CreateHostBuilder(string[] args) =>\n        Host.CreateDefaultBuilder(args)\n            .ConfigureServices((_, services) =>\n            {\n                services.AddInfrastructureServices();\n            });\n}\n")),Object(c.b)("p",null,"\u3053\u308c\u3067\u30de\u30a4\u30b0\u30ec\u30fc\u30b7\u30e7\u30f3\u30d5\u30a1\u30a4\u30eb\u304c\u751f\u6210\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3057\u305f\u3002"),Object(c.b)("p",null,"\u305f\u3060\u305d\u306e\u524d\u306b\u3001SQLite \u306e DB \u306e\u5b9f\u4f53",Object(c.b)("inlineCode",{parentName:"p"},".sqlite"),"\u3068 SQL Client\uff08DB Browser\uff09\u3067\u4f5c\u6210\u3055\u308c\u308b\u4e00\u6642\u30d5\u30a1\u30a4\u30eb\u306f\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306b\u8ffd\u52a0\u3055\u308c\u306a\u3044\u3088\u3046\u306b\u3057\u3001git \u7ba1\u7406\u4e0b\u304b\u3089\u3082\u5916\u3057\u3066\u304a\u304f\u3068\u826f\u3044\u3068\u601d\u3044\u307e\u3059\u3002"),Object(c.b)("pre",null,Object(c.b)("code",{parentName:"pre",className:"language-xml:Infrastructure.csproj"},'<Project Sdk="Microsoft.NET.Sdk">\n  \x3c!--\u7565--\x3e\n  <ItemGroup>\n    <None Remove="*.sqlite" />\n    <None Remove="*.sqlite-shm" />\n    <None Remove="*.sqlite-wal" />\n  </ItemGroup>\n  \x3c!--\u7565--\x3e\n</Project>\n')),Object(c.b)("pre",null,Object(c.b)("code",{parentName:"pre",className:"language-.gitignore:.gitignore"},"# SQLite\n*.sqlite\n*.sqlite-shm\n*.sqlite-wal\n")),Object(c.b)("p",null,"\u30de\u30a4\u30b0\u30ec\u30fc\u30b7\u30e7\u30f3\u30d5\u30a1\u30a4\u30eb\u3092\u751f\u6210\u3057\u307e\u3059\u3002"),Object(c.b)("pre",null,Object(c.b)("code",{parentName:"pre",className:"language-bash\u30de\u30a4\u30b0\u30ec\u30fc\u30b7\u30e7\u30f3\u3059\u308b"},"dotnet ef migrations add InitialCreate --context SqliteECommerceDbContext --output-dir /Migrations/Sqlite -v\n")),Object(c.b)("p",null,Object(c.b)("inlineCode",{parentName:"p"},"--context"),"\u3067 SQLite \u7528\u306e DB \u30b3\u30f3\u30c6\u30ad\u30b9\u30c8\u3092\u6307\u5b9a\u3057\u3066\u3044\u307e\u3059\u3002"),Object(c.b)("p",null,Object(c.b)("inlineCode",{parentName:"p"},"--output-dir"),"\u3067\u30de\u30a4\u30b0\u30ec\u30fc\u30b7\u30e7\u30f3\u30d5\u30a1\u30a4\u30eb\u304c\u751f\u6210\u3055\u308c\u308b\u30d5\u30a9\u30eb\u30c0\u3092\u6307\u5b9a\u3067\u304d\u307e\u3059\u3002\u4ed6\u306e DB \u306e\u3082\u306e\u3068\u6df7\u3056\u3089\u306a\u3044\u3088\u3046\u306b\u30d5\u30a9\u30eb\u30c0\u3092\u5206\u3051\u3066\u304a\u304f\u3068\u3044\u3044\u3068\u601d\u3044\u307e\u3059\u3002"),Object(c.b)("p",null,"\u307e\u305f\u3001",Object(c.b)("inlineCode",{parentName:"p"},"-v"),"\u3092\u3064\u3051\u308b\u3068\u30bf\u30fc\u30df\u30ca\u30eb\u3078\u306e\u51fa\u529b\u304c\u8a73\u3057\u304f\u306a\u308a\u3001\u751f\u6210\u5931\u6557\u6642\u306b\u8abf\u67fb\u3057\u3084\u3059\u304f\u306a\u308a\u307e\u3059\u3002"),Object(c.b)("p",null,"\u4e0b\u8a18\u306e\u3088\u3046\u306b\u30de\u30a4\u30b0\u30ec\u30fc\u30b7\u30e7\u30f3\u30d5\u30a1\u30a4\u30eb\u304c\u751f\u6210\u3055\u308c\u307e\u3059\u3002"),Object(c.b)("pre",null,Object(c.b)("code",{parentName:"pre",className:"language-bash"},"$ tree .\n.\n\u251c\u2500\u2500 ECommerceSample.sln\n(\u7565)\n\u2514\u2500\u2500 src\n    \u251c\u2500\u2500 Application\n    \u251c\u2500\u2500 Domain\n    \u251c\u2500\u2500 Infrastructure\n    \u2502\xa0\xa0 \u251c\u2500\u2500 ECommerceDbContext.cs\n    \u2502\xa0\xa0 \u251c\u2500\u2500 Migrations\n    \u2502\xa0\xa0 (\u7565)\u2514\u2500\u2500 Sqlite\n    \u2502\xa0\xa0  \xa0\xa0     \u251c\u2500\u2500 20210325163438_InitialCreate.Designer.cs\n    \u2502\xa0\xa0  \xa0\xa0     \u251c\u2500\u2500 20210325163438_InitialCreate.cs\n    \u2502\xa0\xa0  \xa0\xa0     \u2514\u2500\u2500 SqliteECommerceDbContextModelSnapshot.cs\n    (\u7565)\n    \u251c\u2500\u2500 WebApi\n    \u2514\u2500\u2500 WebSite\n")),Object(c.b)("p",null,"\u5b9f\u969b\u306b DB \u30de\u30a4\u30b0\u30ec\u30fc\u30b7\u30e7\u30f3\u3057\u3066\u30c6\u30fc\u30d6\u30eb\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002"),Object(c.b)("p",null,"\u4eca\u56de\u306f",Object(c.b)("inlineCode",{parentName:"p"},".sqlite"),"\u30d5\u30a1\u30a4\u30eb\u306e\u751f\u6210\u306b\u306a\u308a\u307e\u3059\u3002"),Object(c.b)("pre",null,Object(c.b)("code",{parentName:"pre",className:"language-bash"},"dotnet ef database update --context SqliteECommerceDbContext  -v\n")),Object(c.b)("p",null,Object(c.b)("inlineCode",{parentName:"p"},"Infrastructure"),"\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u76f4\u4e0b\u306b",Object(c.b)("inlineCode",{parentName:"p"},"ECommerceSample.sqlite"),"\u304c\u751f\u6210\u3055\u308c\u307e\u3057\u305f\u3002"),Object(c.b)("p",null,"\u4e2d\u8eab\u3092\u8997\u304f\u3068\u30c6\u30fc\u30d6\u30eb\u304c\u751f\u6210\u51fa\u6765\u3066\u3044\u308b\u3053\u3068\u304c\u78ba\u8a8d\u3067\u304d\u307e\u3057\u305f\u3002"),Object(c.b)("p",null,Object(c.b)("img",{parentName:"p",src:"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/195024/2f9c7f6d-5b1c-2ac1-dab6-db54f9cd87f8.png",alt:"image.png"})),Object(c.b)("p",null,"\u3053\u308c\u3067\u6570\u30b9\u30bf\u30fc\u30c8\u30a2\u30c3\u30d7\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u69cb\u6210\u306e\u30bd\u30ea\u30e5\u30fc\u30b7\u30e7\u30f3\u3067\u3001DB \u30de\u30a4\u30b0\u30ec\u30fc\u30b7\u30e7\u30f3\u30d5\u30a1\u30a4\u30eb\u3092\u30a4\u30f3\u30d5\u30e9\u5c64\u306e\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306b\u751f\u6210\u3059\u308b\u76ee\u7684\u304c\u9054\u6210\u3067\u304d\u307e\u3057\u305f\u3002"))}s.isMDXComponent=!0}}]);